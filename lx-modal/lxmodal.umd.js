(function(d,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(d=typeof globalThis<"u"?globalThis:d||self,e(d.lxmodal={},d.vue))})(this,function(d,e){"use strict";const g=n=>(e.pushScopeId("data-v-6bf5990b"),n=n(),e.popScopeId(),n),B={class:"modal-header-left"},P=["textContent"],I={class:"modal-header-right"},v=[g(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-zuixiaohua"})],-1))],D={key:0,class:"icon","aria-hidden":"true"},z=[g(()=>e.createElementVNode("use",{"xlink:href":"#icon-zuidahua"},null,-1))],L={key:1,class:"icon","aria-hidden":"true"},R=[g(()=>e.createElementVNode("use",{"xlink:href":"#icon-zuidahua1"},null,-1))],H=[g(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-guanbi"})],-1))],q={class:"modal-header-right"},F=[g(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-guanbi1"})],-1))],A=[g(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-zuidahua2"})],-1))],T=[g(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-zuixiaohua4-copy"})],-1))],W={class:"modal-header-left"},j=["textContent"],U={key:0,class:"modal-footer"},X={name:"ModalContent"},Y=e.defineComponent({...X,props:{title:{type:String,default:"🐽lx-modal"},footerHide:{type:Boolean,default:!1},width:{type:Number,default:500},height:{type:Number,default:250},zIndex:{type:String,default:"100"},resize:{type:Boolean,default:!0},submitModalBeforeEvent:{type:Function,default:null},modalStyle:{type:String,default:"windows"}},emits:["update:modalShow"],setup(n,{expose:i}){const m=n,l=e.getCurrentInstance(),a=e.ref(l==null?void 0:l.appContext.config.globalProperties.uniqueId),r=`draggableDOM-${a.value}`,f=`draggableDOMPoint-${a.value}`,h=e.ref(!1);let c;function E(t,o){requestAnimationFrame(()=>{t.classList.add("modal-transition"),h.value?(document.body.style.overflow="auto",o.style.width=c.width+"px",o.style.height=c.resizeDOMHeight+"px",t.style.width="inherit",t.style.height="inherit",t.style.transform=`translate(${c.left}px,${c.top}px)`,o.style.resize=m.resize?"auto":"none",h.value=!1):(c=t==null?void 0:t.getBoundingClientRect(),c.resizeDOMHeight=o==null?void 0:o.getBoundingClientRect().height,document.body.style.overflow="hidden",t.style.transform="translate(0px,0px)",t.style.width="100vw",t.style.height="100vh",o.style.width="100vw",o.style.resize="none",h.value=!0)})}const u=e.ref(),N=e.ref(),w=e.ref();let y=null;function oe(t){const o=l==null?void 0:l.appContext.config.globalProperties.modalIndex,s={x:5*o,y:5*o},$=t.getBoundingClientRect(),M=document.documentElement;t.style.transform=`translate(${M.clientWidth/2-$.width/2+s.x}px,${M.clientHeight/2-$.height/2+s.y}px)`,document==null||document.addEventListener("dragover",x)}function S(t){h.value||t.target.id!==f&&!u||(y=t,u.value.style.opacity=".92",document==null||document.addEventListener("dragover",x))}function x(t){if(h.value||t.target.id!==f&&!y||!u.value)return;const o=window.innerHeight-y.target.offsetHeight,s=window.innerWidth-y.target.offsetWidth;u.value.style.transform=`translate(${Math.min(Math.max(0,t.clientX-y.offsetX),s)}px,${Math.min(Math.max(0,t.clientY-y.offsetY),o)}px)`,t.preventDefault()}function V(t){u.value.style.opacity="1",document.removeEventListener("dragover",x)}function _(t){switch(t){case"cancel":case"close":case"submit":l==null||l.appContext.config.globalProperties.unmountModal();break}}async function ne(){if(typeof m.submitModalBeforeEvent!="function")return _("submit");await new Promise(()=>{if(m.submitModalBeforeEvent())return _("submit")})}return e.onMounted(()=>{oe(u.value)}),i({uniqueId:a}),(t,o)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"draggableDOMRef",ref:u,id:r,class:"modal-content"},[e.renderSlot(t.$slots,"header",{},()=>[n.modalStyle==="windows"?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"draggableDOMPointRef",ref:N,id:f,class:"modal-header windows",draggable:"true",onDragstart:S,onDrop:V},[e.createElementVNode("div",B,[e.renderSlot(t.$slots,"header-left",{},()=>[e.createElementVNode("span",{class:"modal-header-left-title",textContent:e.toDisplayString(n.title)},null,8,P)],!0)]),e.createElementVNode("div",I,[e.createElementVNode("div",{class:"modal-header-right-btn",onClick:o[0]||(o[0]=s=>t.$emit("update:modalShow",!1))},v),e.createElementVNode("div",{class:"modal-header-right-btn",onClick:o[1]||(o[1]=s=>E(u.value,w.value))},[h.value?(e.openBlock(),e.createElementBlock("svg",D,z)):(e.openBlock(),e.createElementBlock("svg",L,R))]),e.createElementVNode("div",{class:"modal-header-right-btn",onClick:o[2]||(o[2]=s=>_("close"))},H)])],544)):n.modalStyle==="mac"?(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"draggableDOMPointRef",ref:N,id:f,class:"modal-header mac",draggable:"true",onDragstart:S,onDrop:V},[e.createElementVNode("div",q,[e.createElementVNode("div",{class:"modal-header-right-btn",onClick:o[3]||(o[3]=s=>_("close"))},F),e.createElementVNode("div",{class:"modal-header-right-btn",onClick:o[4]||(o[4]=s=>E(u.value,w.value))},A),e.createElementVNode("div",{class:"modal-header-right-btn",onClick:o[5]||(o[5]=s=>t.$emit("update:modalShow",!1))},T)]),e.createElementVNode("div",W,[e.renderSlot(t.$slots,"header-left",{},()=>[e.createElementVNode("span",{class:"modal-header-left-title",textContent:e.toDisplayString(n.title)},null,8,j)],!0)])],544)):e.createCommentVNode("",!0)],!0),e.createElementVNode("div",{ref_key:"resizeDOMRef",ref:w,class:e.normalizeClass(["modal-body scroll-container",{"modal-diy-body":n.footerHide}]),style:e.normalizeStyle(`width: ${n.width}px; height: ${n.height}px ;resize: ${n.resize?"auto":"none"}`)},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6),e.renderSlot(t.$slots,"footer",{},()=>[n.footerHide?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",U,[e.createElementVNode("button",{class:"modal-button",onClick:o[6]||(o[6]=s=>_("cancel"))},"取消"),e.createElementVNode("button",{class:"modal-button modal-button-primary",onClick:ne},"提交")]))],!0)],512))}}),C=(n,i)=>{const m=n.__vccOpts||n;for(const[l,a]of i)m[l]=a;return m},G=C(Y,[["__scopeId","data-v-6bf5990b"]]),J={class:"modal"},K={name:"LxModal"},Q=e.defineComponent({...K,props:{maskClosable:{type:Boolean,default:!0},modalMaskDisplay:{type:Boolean,default:!1}},emits:["close"],setup(n,{expose:i,emit:m}){const l=n,a=e.getCurrentInstance();function r(){l.maskClosable&&(a==null||a.appContext.config.globalProperties.unmountModal())}const f=e.ref(!0);function h(c){f.value=!f.value}return i({modalShow:f,minShowModal:h}),(c,E)=>(e.openBlock(),e.createBlock(e.Transition,null,{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",J,[e.withDirectives(e.createElementVNode("div",{class:"modal-mask",onClick:r},null,512),[[e.vShow,n.modalMaskDisplay]]),e.createVNode(G,e.mergeProps(c.$attrs,{"onUpdate:modalShow":h}),{default:e.withCtx(()=>[e.renderSlot(c.$slots,"default",{},void 0,!0)]),_:3},16)],512),[[e.vShow,f.value]])]),_:3}))}}),b=C(Q,[["__scopeId","data-v-d0e46f78"]]);function Z(){return Math.random().toString(36).substr(2,9)}let p=e.ref(new Map);function O(){p.value.size!==0&&p.value.forEach(n=>{n.config.globalProperties.unmountModal()})}function ee(n,i){return new Promise(m=>{const l=Z(),a=document.createElement("div");a.id=l,document.body.appendChild(a);const r=e.createApp(e.h(b,i,[e.h(n,i)]),{});r.config.globalProperties.modalIndex=p.value.size,r.config.globalProperties.uniqueId=l,p.value.set(l,r),r.mount(a),r.config.globalProperties.unmountModal=function(){p.value.get(l)._instance.exposed.modalShow.value=!1,document.body.style.overflow="auto",p.value.get(l).unmount(),a.remove(),p.value.delete(l)},m({uniqueId:l,element:a,app:r})})}const k=[b],te={install(n){k==null||k.forEach(i=>{n.component(i.name,i)})}};d.LxModal=b,d.ModalInstanceMap=p,d.closeAllModal=O,d.default=te,d.openModal=ee,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
