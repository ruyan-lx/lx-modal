(function(c,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(c=typeof globalThis<"u"?globalThis:c||self,e(c.lxmodal={},c.vue))})(this,function(c,e){"use strict";var Ee=Object.defineProperty;var Me=(c,e,u)=>e in c?Ee(c,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):c[e]=u;var k=(c,e,u)=>(Me(c,typeof e!="symbol"?e+"":e,u),u);const u=t=>(e.pushScopeId("data-v-cc1b2fb9"),t=t(),e.popScopeId(),t),L={class:"modal-header-left"},R=["textContent"],T={class:"modal-header-right"},z=[u(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-zuixiaohua"})],-1))],H={key:0,class:"icon","aria-hidden":"true"},X=[u(()=>e.createElementVNode("use",{"xlink:href":"#icon-zuidahua"},null,-1))],Y={key:1,class:"icon","aria-hidden":"true"},F=[u(()=>e.createElementVNode("use",{"xlink:href":"#icon-zuidahua1"},null,-1))],q=[u(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-guanbi"})],-1))],W={class:"modal-header-right"},A={class:"modal-header-right-btn"},U=[u(()=>e.createElementVNode("use",{"xlink:href":"#icon-guanbi1"},null,-1))],v={class:"modal-header-right-btn"},j=[u(()=>e.createElementVNode("use",{"xlink:href":"#icon-zuidahua2"},null,-1))],G={class:"modal-header-right-btn"},J=[u(()=>e.createElementVNode("use",{"xlink:href":"#icon-zuixiaohua4-copy"},null,-1))],K={class:"modal-header-left"},Q=["textContent"],Z={key:0,class:"modal-footer"},O={name:"ModalContent"},ee=e.defineComponent({...O,props:{modalTitle:{type:String,default:"🐽lx-modal"},footerHide:{type:Boolean,default:!1},width:{type:Number,default:500},height:{type:Number,default:250},zIndex:{type:String,default:"100"},resize:{type:Boolean,default:!0},submitModalBeforeEvent:{type:Function,default:null},modalStyle:{type:String,default:"windows"}},emits:["update:modalShow"],setup(t,{expose:s}){const m=t,n=e.getCurrentInstance(),l=e.ref(n==null?void 0:n.appContext.config.globalProperties.uniqueId),h=`draggableDOM-${l.value}`,r=`draggableDOMPoint-${l.value}`,a=e.ref(!1);let d;function p(o,i){requestAnimationFrame(()=>{o.classList.add("modal-transition"),a.value?(document.body.style.overflow="auto",i.style.width=d.width+"px",i.style.height=d.resizeDOMHeight+"px",o.style.width="inherit",o.style.height="inherit",o.style.transform=`translate(${d.left}px,${d.top}px)`,i.style.resize=m.resize?"auto":"none",a.value=!1):(d=o==null?void 0:o.getBoundingClientRect(),d.resizeDOMHeight=i==null?void 0:i.getBoundingClientRect().height,document.body.style.overflow="hidden",o.style.transform="translate(0px,0px)",o.style.width="100vw",o.style.height="100vh",i.style.width="100vw",i.style.resize="none",a.value=!0)})}const f=e.ref(),_=e.ref(),b=e.ref();let w=null;function be(o){const i=n==null?void 0:n.appContext.config.globalProperties.modalIndex,g={x:5*i,y:5*i},P=o.getBoundingClientRect(),I=document.documentElement;o.style.transform=`translate(${I.clientWidth/2-P.width/2+g.x}px,${I.clientHeight/2-P.height/2+g.y}px)`,document==null||document.addEventListener("dragover",C)}function N(o){a.value||o.target.id!==r&&!f||(w=o,document==null||document.addEventListener("dragover",C))}function C(o){if(a.value||o.target.id!==r&&!w||!f.value)return;const i=window.innerHeight-w.target.offsetHeight,g=window.innerWidth-w.target.offsetWidth;f.value.style.transform=`translate(${Math.min(Math.max(0,o.clientX-w.offsetX),g)}px,${Math.min(Math.max(0,o.clientY-w.offsetY),i)}px)`,o.preventDefault()}function D(o){document.removeEventListener("dragover",C)}function y(o){switch(o){case"cancel":case"close":case"submit":n==null||n.appContext.config.globalProperties.unmountModal();break}}async function ye(){if(typeof m.submitModalBeforeEvent!="function")return y("submit");await new Promise(()=>{if(m.submitModalBeforeEvent())return y("submit")})}return e.onMounted(()=>{be(f.value)}),s({uniqueId:l}),(o,i)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"draggableDOMRef",ref:f,id:h,class:"modal-content"},[e.renderSlot(o.$slots,"header",{},()=>[t.modalStyle==="windows"?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"draggableDOMPointRef",ref:_,id:r,class:"modal-header windows",draggable:"true",onDragstart:N,onDrop:D},[e.createElementVNode("div",L,[e.renderSlot(o.$slots,"header-left",{},()=>[e.createElementVNode("span",{class:"modal-header-left-title",textContent:e.toDisplayString(t.modalTitle)},null,8,R)],!0)]),e.createElementVNode("div",T,[e.createElementVNode("div",{class:"modal-header-right-btn",onClick:i[0]||(i[0]=g=>o.$emit("update:modalShow",!1))},z),e.createElementVNode("div",{class:"modal-header-right-btn",onClick:i[1]||(i[1]=g=>p(f.value,b.value))},[a.value?(e.openBlock(),e.createElementBlock("svg",H,X)):(e.openBlock(),e.createElementBlock("svg",Y,F))]),e.createElementVNode("div",{class:"modal-header-right-btn",onClick:i[2]||(i[2]=g=>y("close"))},q)])],544)):t.modalStyle==="mac"?(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"draggableDOMPointRef",ref:_,id:r,class:"modal-header mac",draggable:"true",onDragstart:N,onDrop:D},[e.createElementVNode("div",W,[e.createElementVNode("div",A,[(e.openBlock(),e.createElementBlock("svg",{class:"icon","aria-hidden":"true",onClick:i[3]||(i[3]=g=>y("close"))},U))]),e.createElementVNode("div",v,[(e.openBlock(),e.createElementBlock("svg",{class:"icon","aria-hidden":"true",onClick:i[4]||(i[4]=g=>p(f.value,b.value))},j))]),e.createElementVNode("div",G,[(e.openBlock(),e.createElementBlock("svg",{class:"icon","aria-hidden":"true",onClick:i[5]||(i[5]=g=>o.$emit("update:modalShow",!1))},J))])]),e.createElementVNode("div",K,[e.renderSlot(o.$slots,"header-left",{},()=>[e.createElementVNode("span",{class:"modal-header-left-title",textContent:e.toDisplayString(t.modalTitle)},null,8,Q)],!0)])],544)):e.createCommentVNode("",!0)],!0),e.createElementVNode("div",{ref_key:"resizeDOMRef",ref:b,class:e.normalizeClass(["modal-body scroll-container",{"modal-diy-body":t.footerHide}]),style:e.normalizeStyle(`width: ${t.width}px; height: ${t.height}px ;resize: ${t.resize?"auto":"none"}`)},[e.renderSlot(o.$slots,"default",{},void 0,!0)],6),e.renderSlot(o.$slots,"footer",{},()=>[t.footerHide?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Z,[e.createElementVNode("button",{class:"modal-button",onClick:i[6]||(i[6]=g=>y("cancel"))},"取消"),e.createElementVNode("button",{class:"modal-button modal-button-primary",onClick:ye},"提交")]))],!0)],512))}}),E=(t,s)=>{const m=t.__vccOpts||t;for(const[n,l]of s)m[n]=l;return m},te=E(ee,[["__scopeId","data-v-cc1b2fb9"]]),oe={class:"modal"},ne={name:"LxModal"},le=e.defineComponent({...ne,props:{maskClosable:{type:Boolean,default:!0},modalMaskDisplay:{type:Boolean,default:!1}},emits:["close"],setup(t,{expose:s,emit:m}){const n=t,l=e.getCurrentInstance();function h(){n.maskClosable&&(l==null||l.appContext.config.globalProperties.unmountModal())}const r=e.ref(!0);function a(d){r.value=!r.value}return s({modalShow:r,minShowModal:a}),(d,p)=>(e.openBlock(),e.createBlock(e.Transition,null,{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",oe,[e.withDirectives(e.createElementVNode("div",{class:"modal-mask",onClick:h},null,512),[[e.vShow,t.modalMaskDisplay]]),e.createVNode(te,e.mergeProps(d.$attrs,{"onUpdate:modalShow":a}),{default:e.withCtx(()=>[e.renderSlot(d.$slots,"default",{},void 0,!0)]),_:3},16)],512),[[e.vShow,r.value]])]),_:3}))}}),M=E(le,[["__scopeId","data-v-d0e46f78"]]);function se(){return Math.random().toString(36).substr(2,9)}let x=e.ref(new Map);function $(){x.value.size!==0&&x.value.forEach(t=>{t.config.globalProperties.unmountModal()})}function ie(t,s){return new Promise(m=>{const n=se(),l=document.createElement("div");l.id=n,document.body.appendChild(l);const h=e.createApp(e.h(M,s,[e.h(t,s)]),{});h.config.globalProperties.modalIndex=x.value.size,h.config.globalProperties.uniqueId=n,x.value.set(n,h),h.mount(l),h.config.globalProperties.unmountModal=function(){x.value.get(n)._instance.exposed.modalShow.value=!1,document.body.style.overflow="auto",x.value.get(n).unmount(),l.remove(),x.value.delete(n)},m({uniqueId:n,element:l,app:h})})}class ae{constructor(s){k(this,"element");k(this,"startX",0);k(this,"startY",0);k(this,"isDragging",!1);k(this,"adsorb");this.element=document.querySelector(s.el),this.adsorb=s.adsorb,this.element?(this.element.addEventListener("mousedown",this.onMouseDown.bind(this)),document.addEventListener("mousemove",this.onMouseMove.bind(this),{capture:!0}),document.addEventListener("mouseup",this.onMouseUp.bind(this),{capture:!0})):console.error(`Element with selector '${s.el}' not found.`)}onMouseDown(s){this.element&&s.target===this.element&&(s.preventDefault(),this.startX=s.clientX-this.element.offsetLeft,this.startY=s.clientY-this.element.offsetTop,this.isDragging=!0)}onMouseMove(s){if(this.isDragging){s.preventDefault();const m=s.clientX-this.startX,n=s.clientY-this.startY,l=window.innerWidth,h=window.innerHeight,r=this.element.getBoundingClientRect(),a=0,d=0,p=l-r.width,f=h-r.height;let _=Math.min(Math.max(m,a),p),b=Math.min(Math.max(n,d),f);this.element.style.left=_+"px",this.element.style.top=b+"px"}}onMouseUp(s){if(this.isDragging&&(s.preventDefault(),this.isDragging=!1,this.adsorb)){const m=window.innerWidth,n=window.innerHeight,l=this.element.getBoundingClientRect();let h=l.left,r=l.top;const a=l.left,d=m-(l.left+l.width),p=l.top,f=n-(l.top+l.height),_=Math.min(a,d,p,f);_===a?h=0:_===d&&(h=m-l.width),_===p?r=0:_===f&&(r=n-l.height),this.element.style.left=h+"px",this.element.style.top=r+"px"}}}const S=t=>(e.pushScopeId("data-v-0031aae5"),t=t(),e.popScopeId(),t),de={class:"lx-modal-box"},re=["textContent"],ce={id:"box2",class:"lx-modal-box-max"},me={class:"header-box"},he=[S(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-guanbi"})],-1))],fe={key:0},ue=["onClick"],pe=["onClick"],ge=[S(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-guanbi1"})],-1))],_e={key:1,class:"lx-modal-box-max-nodata"},xe={name:"LxModalBox"},we=e.defineComponent({...xe,props:{modelValue:{type:Map,default:new Map},modelModifiers:{},showbox:{type:Boolean,default:!1},showboxModifiers:{}},emits:["update:modelValue","update:showbox"],setup(t,{expose:s}){const m=e.useModel(t,"modelValue"),n=e.useModel(t,"showbox");function l(r,a){a._instance.exposed.minShowModal()}function h(r,a){a.config.globalProperties.unmountModal()}return s({}),e.onMounted(()=>{new ae({el:"#box1",adsorb:!0})}),(r,a)=>(e.openBlock(),e.createElementBlock("div",de,[e.withDirectives(e.createElementVNode("div",{id:"box1",class:"lx-modal-box-min",onDblclick:a[0]||(a[0]=d=>n.value=!0)},[e.createElementVNode("span",{textContent:e.toDisplayString(m.value.size)},null,8,re)],544),[[e.vShow,!n.value]]),e.withDirectives(e.createElementVNode("div",ce,[e.createElementVNode("div",me,[e.createElementVNode("div",{class:"allclose-div",onClick:a[1]||(a[1]=(...d)=>e.unref($)&&e.unref($)(...d))},"关闭所有"),e.createElementVNode("div",{class:"close-div",onClick:a[2]||(a[2]=d=>n.value=!1)},he)]),m.value.size>0?(e.openBlock(),e.createElementBlock("ul",fe,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value,([d,p])=>(e.openBlock(),e.createElementBlock("li",{key:d},[e.createElementVNode("div",{onClick:f=>l(d,p)},e.toDisplayString(p._instance.attrs.modalTitle),9,ue),e.createElementVNode("div",{onClick:f=>h(d,p)},ge,8,pe)]))),128))])):(e.openBlock(),e.createElementBlock("div",_e,"你没有未关闭的弹窗~"))],512),[[e.vShow,n.value]])]))}}),V=E(we,[["__scopeId","data-v-0031aae5"]]),B=[M,V],ke={install(t){B==null||B.forEach(s=>{t.component(s.name,s)})}};c.LxModal=M,c.LxModalBox=V,c.ModalInstanceMap=x,c.closeAllModal=$,c.default=ke,c.openModal=ie,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
