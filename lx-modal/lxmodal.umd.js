(function(s,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(s=typeof globalThis<"u"?globalThis:s||self,e(s.lxmodal={},s.vue))})(this,function(s,e){"use strict";const p=l=>(e.pushScopeId("data-v-9b85fced"),l=l(),e.popScopeId(),l),M={class:"modal-header-left"},x={class:"modal-header-left-title"},k={class:"modal-header-right"},w=[p(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-zuixiaohua"})],-1))],C={key:0,class:"icon","aria-hidden":"true"},B=[p(()=>e.createElementVNode("use",{"xlink:href":"#icon-zuidahua"},null,-1))],N={key:1,class:"icon","aria-hidden":"true"},S=[p(()=>e.createElementVNode("use",{"xlink:href":"#icon-zuidahua1"},null,-1))],$=[p(()=>e.createElementVNode("svg",{class:"icon","aria-hidden":"true"},[e.createElementVNode("use",{"xlink:href":"#icon-guanbi"})],-1))],V=["style:any"],I={key:0,class:"modal-footer"},D=e.defineComponent({__name:"ModalContent",props:{id:{type:Number,default:0},title:{type:String,default:"🐽lx-modal"},footerHide:{type:Boolean,default:!1},width:{type:Number,default:500},height:{type:Number,default:250},zIndex:{type:String,default:"100"},maskClosable:{type:Boolean,default:!0},ModalMaskDisplay:{type:Boolean,default:!1},resize:{type:String,default:"auto"},submitModalBeforeEvent:{type:Function,default:null}},emits:["update:modalShow"],setup(l,{expose:r}){const i=l,o=e.getCurrentInstance(),a=e.ref(o==null?void 0:o.appContext.config.globalProperties.uniqueId),d=`draggableDOM-${a.value}`,f=`draggableDOMPoint-${a.value}`,c=`resizeDOM-${a.value}`,h=e.ref(!1);function v(){let t=document.getElementById(d);const n=document.getElementById(c);h.value?(requestAnimationFrame(()=>{document.body.style.overflow="auto",n.style.width=i.width+"px",n.style.height=i.height+"px",t.style.width="inherit",t.style.height="inherit",t.style.transform=`translate(${document.documentElement.clientWidth/2-t.offsetWidth/2}px,${document.documentElement.clientHeight/2-t.offsetHeight/2}px)`}),h.value=!1):(document.body.style.overflow="hidden",t.style.transform="translate(0px,0px)",t.style.height="100vh",requestAnimationFrame(()=>{n.style.width="100vw",n.style.resize="none"}),h.value=!0)}function y(t){o==null||o.appContext.config.globalProperties.unmountModal(),console.log("==type==",t)}async function F(){if(typeof i.submitModalBeforeEvent!="function")return y("submit");await new Promise(()=>{if(i.submitModalBeforeEvent())return y("submit")})}e.onMounted(()=>{L()});function L(){let t=null;const n=document.getElementById(d);let m=document.getElementById(f);const b=o==null?void 0:o.appContext.config.globalProperties.modalIndex,E={x:5*b,y:5*b};n.style.transform=`translate(${document.documentElement.clientWidth/2-n.offsetWidth/2+E.x}px,${document.documentElement.clientHeight/2-n.offsetHeight/2+E.y}px)`,m==null||m.addEventListener("dragstart",u=>{u.target.id!==f&&!n||(t=u,n.style.opacity=".7")}),document==null||document.addEventListener("dragover",u=>{if(u.target.id!==f&&!t)return;const A=window.innerHeight-t.target.offsetHeight,T=window.innerWidth-t.target.offsetWidth;n.style.transform=`translate(${Math.min(Math.max(0,u.clientX-t.offsetX),T)}px,${Math.min(Math.max(0,u.clientY-t.offsetY),A)}px)`,u.preventDefault()}),n==null||n.addEventListener("drop",()=>{t=null,m=null,n.style.opacity="1"})}return r({uniqueId:a}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{id:d,class:"modal-content"},[e.createElementVNode("div",{id:f,class:"modal-header",draggable:"true"},[e.createElementVNode("div",M,[e.renderSlot(t.$slots,"header",{},()=>[e.createElementVNode("span",x,e.toDisplayString(l.title),1)],!0)]),e.createElementVNode("div",k,[e.createElementVNode("div",{class:"modal-header-right-btn",onClick:n[0]||(n[0]=m=>t.$emit("update:modalShow",!1))},w),e.createElementVNode("div",{class:"modal-header-right-btn",onClick:v},[h.value?(e.openBlock(),e.createElementBlock("svg",C,B)):(e.openBlock(),e.createElementBlock("svg",N,S))]),e.createElementVNode("div",{class:"modal-header-right-btn",onClick:n[1]||(n[1]=m=>y("close"))},$)])]),e.createElementVNode("div",{id:c,class:"modal-body","style:any":{width:`${l.width}px`,height:`${l.height}px`,resize:l.resize}},[e.renderSlot(t.$slots,"default",{},void 0,!0)],8,V),e.renderSlot(t.$slots,"footer",{},()=>[l.footerHide?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",I,[e.createElementVNode("button",{class:"modal-button",onClick:n[2]||(n[2]=m=>y("cancel"))},"取消"),e.createElementVNode("button",{class:"modal-button modal-button-primary",onClick:F},"提交")]))],!0)]))}}),_=(l,r)=>{const i=l.__vccOpts||l;for(const[o,a]of r)i[o]=a;return i},z=_(D,[["__scopeId","data-v-9b85fced"]]),P={class:"modal"},q=_(e.defineComponent({__name:"index",props:{maskClosable:{type:Boolean,default:!0},ModalMaskDisplay:{type:Boolean,default:!1}},emits:["close"],setup(l,{emit:r}){const i=l,o=e.getCurrentInstance();function a(){i.maskClosable&&(o==null||o.appContext.config.globalProperties.unmountModal())}const d=e.ref(!0);function f(c){d.value=c}return(c,h)=>e.withDirectives((e.openBlock(),e.createElementBlock("div",P,[e.withDirectives(e.createElementVNode("div",{class:"modal-mask",onClick:a},null,512),[[e.vShow,l.ModalMaskDisplay]]),e.createVNode(z,e.mergeProps(c.$attrs,{"onUpdate:modalShow":f}),{default:e.withCtx(()=>[e.renderSlot(c.$slots,"default",{},void 0,!0)]),_:3},16)],512)),[[e.vShow,d.value]])}}),[["__scopeId","data-v-cd541b9d"]]);function H(){return Math.random().toString(36).substr(2,9)}let g=e.ref(new Map);function O(l,r){return new Promise(i=>{const o=H(),a=document.createElement("div");a.id=o,document.body.appendChild(a);const d=e.createApp(e.h(q,r,[e.h(l,r)]));d.config.globalProperties.modalIndex=g.value.size,d.config.globalProperties.uniqueId=o,g.value.set(o,d),d.mount(a),d.config.globalProperties.unmountModal=function(){document.body.style.overflow="auto",g.value.get(o).unmount(),a.remove(),g.value.delete(o)},i({uniqueId:o,element:a,app:d})})}const W={};s.default=W,s.openModal=O,Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
